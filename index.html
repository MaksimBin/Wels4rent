<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>wheels4rent — Калькулятор аренды</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0b0d10; --panel:#121417; --text:#e9f1f5; --muted:#a9b6bd;
      --accent:#00e6ff; --accent2:#00b8c8; --radius:8px; --line:#1f2328;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:0; background:var(--bg); color:var(--text);
      font-family:Arial,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",sans-serif;
    }
    .wrap{
      max-width:440px; width:94%; margin:20px auto; padding:18px;
      background:var(--panel); border-radius:12px;
      box-shadow:0 8px 24px rgba(0,230,255,0.12);
      border:1px solid rgba(0,230,255,0.08);
    }

    /* Brand header */
    .brand{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    .brand .title{
      font-size:18px; font-weight:700; color:var(--accent);
      text-shadow:0 0 12px rgba(0,230,255,0.25);
    }
    .brand .badge{
      font-size:12px; color:var(--muted); background:#0e1114;
      border:1px solid var(--line); padding:6px 10px; border-radius:var(--radius);
      transition:all .2s ease;
    }
    .brand a{text-decoration:none}
    .brand a:hover .badge{
      color:var(--accent); border-color:var(--accent);
      box-shadow:0 0 10px rgba(0,230,255,0.25);
    }

    /* Карусель */
    .carousel{
      position:relative; overflow:hidden; border-radius:var(--radius);
      background:#0e1114; border:1px solid var(--line);
    }
    .carousel img{ width:100%; display:block; aspect-ratio:16/9; object-fit:cover }
    .nav{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:space-between;
      padding:0 8px;
    }
    .nav button{
      width:34px; height:34px; border:none; border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      color:#001317; font-weight:800; cursor:pointer;
      box-shadow:0 6px 16px rgba(0,230,255,0.25);
    }

    .caption{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      padding:10px 8px 0;
    }
    .car-name{ font-size:14px; color:var(--muted) }
    .car-price{ font-size:14px; font-weight:700; color:var(--text) }
    .choose{
      margin-left:auto; padding:8px 12px; border:none; border-radius:var(--radius);
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#001317; font-weight:700; cursor:pointer;
      box-shadow:0 6px 16px rgba(0,230,255,0.25);
    }

    /* Формы */
    .field{ margin-top:14px }
    .label{ font-size:13px; color:var(--muted); margin-bottom:6px }
    input[type="number"]{
      width:100%; padding:12px; font-size:14px; color:var(--text);
      background:#0e1114; border:1px solid var(--line); border-radius:var(--radius);
      outline:none; transition:box-shadow .2s ease, border-color .2s ease, background .2s ease;
    }
    input[type="number"]:focus{
      border-color:rgba(0,230,255,0.45);
      box-shadow:0 0 0 4px rgba(0,230,255,0.15);
      background:#101419;
    }

    .options{
      margin-top:12px; padding:10px; border-radius:var(--radius);
      background:#0e1114; border:1px solid var(--line);
    }
    .opt{ display:flex; align-items:center; justify-content:space-between; padding:6px 0 }
    .opt label{ display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text) }
    .opt .price{ font-size:13px; color:var(--muted) }
    input[type="checkbox"]{ accent-color:var(--accent); width:18px; height:18px }
    .divider{ height:1px; background:var(--line); border:none; margin:8px 0 }

    /* Кнопки */
    .calc,.share{
      width:100%; margin-top:14px; padding:14px; border:none; border-radius:var(--radius);
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#001317; font-weight:800; font-size:15px; cursor:pointer;
      box-shadow:0 10px 24px rgba(0,230,255,0.28);
    }
    .calc:hover,.share:hover{ filter:brightness(1.05) }

    /* Результат */
    #result{ margin-top:14px }
    .row{ display:flex; justify-content:space-between; align-items:center; padding:6px 0; color:var(--muted); font-size:14px }
    .total{
      margin-top:10px; padding:12px; border-radius:var(--radius);
      background:#0e1114; border:1px solid rgba(0,230,255,0.35);
      display:flex; justify-content:space-between; align-items:center;
      color:var(--accent); font-weight:800; font-size:16px;
      text-shadow:0 0 10px rgba(0,230,255,0.2);
    }

    /* Toast */
    .toast{
      position:fixed; bottom:20px; left:50%; transform:translateX(-50%);
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#001317; padding:10px 18px; border-radius:var(--radius);
      font-weight:700; font-size:14px; box-shadow:0 6px 16px rgba(0,230,255,0.35);
      opacity:0; pointer-events:none; transition:opacity .25s ease; z-index:999;
    }
    .toast.show{ opacity:1 }

    /* Мобильная адаптация */
    @media (max-width:480px){
      .wrap{ padding:16px }
      .choose{ padding:7px 10px; font-size:12px }
      .calc,.share{ padding:12px; font-size:14px }
      .row{ font-size:13px }
      .total{ font-size:15px }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <div class="title">Калькулятор аренды</div>
      <a href="https://wheels4rent.ru/?ysclid=mkdxsvjkpl143696543" target="_blank" rel="noopener">
        <div class="badge">wheels4rent.ru</div>
      </a>
    </div>

    <div class="carousel">
      <img id="carImage" src="" alt="Авто" />
      <div class="nav">
        <button aria-label="Предыдущее" onclick="prevCar()">‹</button>
        <button aria-label="Следующее" onclick="nextCar()">›</button>
      </div>
    </div>
    <div class="caption">
      <div class="car-name" id="carName"></div>
      <div class="car-price" id="carPrice"></div>
      <button class="choose" id="chooseBtn" onclick="chooseCar()">Выбрать</button>
    </div>

    <div class="field">
      <div class="label">Срок аренды (дней)</div>
      <input type="number" id="days" value="1" min="1" inputmode="numeric" />
    </div>

    <div class="options">
      <div class="opt"><label><input type="checkbox" id="gps" /> GPS</label><div class="price">+300 ₽/день</div></div>
      <div class="opt"><label><input type="checkbox" id="childseat" /> Детское кресло</label><div class="price">+200 ₽/день</div></div>
      <div class="opt"><label><input type="checkbox" id="driver" /> Доп. водитель</label><div class="price">+500 ₽/день</div></div>
      <div class="opt"><label><input type="checkbox" id="insurance" /> Расширенная страховка</label><div class="price">+700 ₽/день</div></div>

      <hr class="divider" />

      <div class="opt"><label><input type="checkbox" id="nospeed" /> Без ограничения скорости</label><div class="price">+1000 ₽/день</div></div>
      <div class="opt"><label><input type="checkbox" id="nomileage" /> Без ограничения по пробегу</label><div class="price">+800 ₽/день</div></div>
      <div class="opt"><label><input type="checkbox" id="protection" /> Защита от неприятностей</label><div class="price">+1200 ₽/день</div></div>

      <hr class="divider" />

      <div class="opt"><label><input type="checkbox" id="friend" /> Приведи друга</label><div class="price">−5%</div></div>
      <div class="opt"><label><input type="checkbox" id="birthday" /> День рождения</label><div class="price">−15%</div></div>
    </div>

    <button class="calc" onclick="calculate()">Рассчитать</button>
    <div id="result"></div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast">Скопировано!</div>

  <script>
    // Массив автомобилей — реальные ссылки
    const cars = [
      { name: "Эконом — Hyundai Solaris", price: 6000, img: "https://avatars.mds.yandex.net/get-autoru-vos/1932996/607ecbaa91b6bad94e82e5ca567c77d7/1200x900" },
      { name: "Комфорт — Toyota Corolla", price: 8000, img: "https://i.ytimg.com/vi/cvQUIOkBVH4/maxresdefault.jpg" },
      { name: "Бизнес — BMW 5 Series", price: 12000, img: "https://avatars.mds.yandex.net/get-autoru-vos/2164639/06720ea57ed9f43650777a74ab5e4e47/1200x900" },
      { name: "SUV — Toyota RAV4", price: 15000, img: "https://avatars.mds.yandex.net/get-autoru-vos/17394937/075da5709f6aefba0fafa223d28808f2/1200x900" },
      { name: "Электро — Tesla Model 3", price: 10000, img: "https://i.ytimg.com/vi/K0ziKtKX0yY/maxresdefault.jpg" }
    ];

    let currentCar = 0;
    let chosenCarIndex = 0;

    function renderCar(i){
      const c = cars[i];
      document.getElementById("carImage").src = c.img;
      document.getElementById("carName").textContent = c.name;
      document.getElementById("carPrice").textContent = `${c.price.toLocaleString("ru-RU")} ₽/сутки`;
    }
    function prevCar(){ currentCar = (currentCar - 1 + cars.length) % cars.length; renderCar(currentCar); }
    function nextCar(){ currentCar = (currentCar + 1) % cars.length; renderCar(currentCar); }
    function chooseCar(){
      chosenCarIndex = currentCar;
      const btn = document.getElementById("chooseBtn");
      btn.textContent = "Выбрано";
      setTimeout(()=>btn.textContent="Выбрать", 1200);
    }
    function checked(id){ return document.getElementById(id).checked; }

    function buildSelectedOptionsList(days){
      const opts = [
        { id:"gps",        label:"GPS",                         perDay:300 },
        { id:"childseat",  label:"Детское кресло",             perDay:200 },
        { id:"driver",     label:"Доп. водитель",              perDay:500 },
        { id:"insurance",  label:"Расширенная страховка",      perDay:700 },
        { id:"nospeed",    label:"Без ограничения скорости",   perDay:1000 },
        { id:"nomileage",  label:"Без ограничения по пробегу", perDay:800 },
        { id:"protection", label:"Защита от неприятностей",    perDay:1200 }
      ];
      const selected = opts.filter(o => checked(o.id));
      const lines = selected.map(o => `• ${o.label}: +${o.perDay.toLocaleString("ru-RU")} ₽/день × ${days} = ${(o.perDay*days).toLocaleString("ru-RU")} ₽`);
      return { selected, lines };
    }

    function calculate(){
      const daysRaw = parseInt(document.getElementById("days").value);
      const days = Math.max(1, isNaN(daysRaw) ? 1 : daysRaw);

      const car = cars[chosenCarIndex];

      const extrasPerDay =
        (checked("gps")?300:0) +
        (checked("childseat")?200:0) +
        (checked("driver")?500:0) +
        (checked("insurance")?700:0) +
        (checked("nospeed")?1000:0) +
        (checked("nomileage")?800:0) +
        (checked("protection")?1200:0);

      const baseTotal   = car.price * days;
      const extrasTotal = extrasPerDay * days;
      let total = baseTotal + extrasTotal;

      const applied = [];
      // Скидки последовательно от текущей суммы
      if (checked("birthday")) {
        const d = total * 0.15; total -= d;
        applied.push({label:"День рождения −15%", value:d});
      }
      if (checked("friend")) {
        const d = total * 0.05; total -= d;
        applied.push({label:"Приведи друга −5%", value:d});
      }

      const { lines: optionLines } = buildSelectedOptionsList(days);

      const resText =
        `Аренда авто: ${car.name}\n` +
        `Срок: ${days} дн.\n` +
        `База: ${baseTotal.toLocaleString("ru-RU")} ₽\n` +
        `Опции (${optionLines.length ? optionLines.length : 0}):\n` +
        (optionLines.length ? optionLines.join("\n") : "• Без дополнительных опций") + "\n" +
        `Сумма опций: ${extrasTotal.toLocaleString("ru-RU")} ₽\n` +
        (applied.length ? applied.map(d=>`${d.label}: −${Math.round(d.value).toLocaleString("ru-RU")} ₽`).join("\n") + "\n" : "") +
        `Итого: ${Math.round(total).toLocaleString("ru-RU")} ₽`;

      const res = document.getElementById("result");
      res.innerHTML = `
        <div class="row"><span>Авто</span><span>${car.name}</span></div>
        <div class="row"><span>Срок</span><span>${days} дн.</span></div>
        <div class="row"><span>База</span><span>${baseTotal.toLocaleString("ru-RU")} ₽</span></div>
        <div class="row"><span>Опции</span><span>${extrasTotal.toLocaleString("ru-RU")} ₽</span></div>
        ${applied.map(d=>`<div class="row"><span>${d.label}</span><span>−${Math.round(d.value).toLocaleString("ru-RU")} ₽</span></div>`).join("")}
        <div class="total"><span>Итого</span><span>${Math.round(total).toLocaleString("ru-RU")} ₽</span></div>
        <button class="share" onclick="shareTelegram(\`${resText}\`)">Поделиться в Telegram</button>
        <button class="share" onclick="shareWhatsApp(\`${resText}\`)">Поделиться в WhatsApp</button>
        <button class="share" onclick="copyResult(\`${resText}\`)">Скопировать</button>
      `;
      res.scrollIntoView({behavior:"smooth", block:"center"});
    }

    // Открытие приложения с fallback на веб
    function openUrlWithFallback(appUrl, webUrl){
      let opened = false;
      try {
        const w = window.open(appUrl, "_blank");
        opened = !!w;
      } catch(e){ opened = false; }
      setTimeout(()=>{
        if (!opened) window.open(webUrl, "_blank");
      }, 400);
    }

    function shareTelegram(text){
      const enc = encodeURIComponent(text);
      const appUrl = `tg://share?text=${enc}`;
      const webUrl = `https://t.me/share/url?url=&text=${enc}`;
      openUrlWithFallback(appUrl, webUrl);
    }

    function shareWhatsApp(text){
      const enc = encodeURIComponent(text);
      const appUrl = `whatsapp://send?text=${enc}`;
      const webUrl = `https://api.whatsapp.com/send?text=${enc}`;
      openUrlWithFallback(appUrl, webUrl);
    }

    function copyResult(text){
      navigator.clipboard.writeText(text).then(()=>{
        const toast = document.getElementById("toast");
        toast.textContent = "Скопировано!";
        toast.classList.add("show");
        setTimeout(()=>toast.classList.remove("show"), 1000);
      }).catch(()=>{
        const toast = document.getElementById("toast");
        toast.textContent = "Не удалось скопировать";
        toast.classList.add("show");
        setTimeout(()=>toast.classList.remove("show"), 1200);
      });
    }

    // Инициализация
    renderCar(currentCar);
    chooseCar(); // по умолчанию выбран первый
  </script>
</body>
</html>